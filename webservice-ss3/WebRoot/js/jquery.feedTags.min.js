/*
 *	feedTags
 *	轻博客标签
 */
(function(e){function j(b,d,a){a&&b.empty();for(var d=d.val().split(","),a=0,f=d.length;a<f;a++){var c=e.trim(d[a]);if(""!=c){var h=b,g=[];g.push('<span class="tagshow">');g.push(c);g.push("</span>");g=g.join("");h.append(g)}}}function n(b,d){var a=e('<textarea class="inputTag" rows="1"></textarea>');a.appendTo(b);b.click(function(){a.focus()});a.focus(function(){e(this).css({border:"0"})});a.blur(function(){i(b,a,d)});a.keydown(function(c){var c=c||window.event,e=c.keyCode||c.charCode;if(188==e||32==e)i(b,a,d),window.setTimeout(function(){a.val(a.val().replace(/^[,\uFF0C]/,""))},10);c.ctrlKey&&86==e&&window.setTimeout(function(){i(b,a,d)},10)});for(var f=d.val().split(","),c=0,h=f.length;c<h;c++){var g=e.trim(f[c]);""!=g&&k(b,a,d,g)}}function k(b,d,a,f){var c=[];c.push('<span class="tag">');c.push('<a href="javascript:;" title="\u5220\u9664"></a>');c.push(f);c.push("</span>");c=c.join("");c=d.before(c).prev();c.children("a").click(function(){e(this).parent().remove();l(b,a)})}function i(b,d,a){var f=e.trim(d.val());if(""!=f)for(var f=f.replace(/([,\s\uFF0C]+)/g,",").split(","),c=0,h=f.length;c<h;c++){var g=f[c].replace(/</g,"&lt;").replace(/>/g,"&gt;");k(b,d,a,g)}d.val("");l(b,a)}function l(b,d){var a=[];b.children("span").each(function(){a.push(e(this).text())});a=a.join(",");d.val(a)}var m={tags:null,isview:!1};e.fn.feedTags=function(b){var b=e.extend({},m,b||{}),d=e(this);d.addClass("feedTags");b.isview?j(d,b.tags,!1):n(d,b.tags)};e.fn.feedTagsLoad=function(b){var b=e.extend({},m,b||{}),d=e(this);j(d,b.tags,!0)}})(jQuery);
